<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>移动端兼容处理 | Awesome-FE</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="个人笔记">
    
    <link rel="preload" href="/awesome/assets/css/0.styles.19f9fd21.css" as="style"><link rel="preload" href="/awesome/assets/js/app.25e7e7c5.js" as="script"><link rel="preload" href="/awesome/assets/js/2.b179fbd3.js" as="script"><link rel="preload" href="/awesome/assets/js/14.be50f30a.js" as="script"><link rel="prefetch" href="/awesome/assets/js/10.df3b6c1e.js"><link rel="prefetch" href="/awesome/assets/js/100.b37f94a2.js"><link rel="prefetch" href="/awesome/assets/js/11.f9f57b79.js"><link rel="prefetch" href="/awesome/assets/js/12.9c216177.js"><link rel="prefetch" href="/awesome/assets/js/13.25d602b8.js"><link rel="prefetch" href="/awesome/assets/js/15.170e1912.js"><link rel="prefetch" href="/awesome/assets/js/16.bfd9f989.js"><link rel="prefetch" href="/awesome/assets/js/17.7c2fdba3.js"><link rel="prefetch" href="/awesome/assets/js/18.79b438cd.js"><link rel="prefetch" href="/awesome/assets/js/19.90ade5a3.js"><link rel="prefetch" href="/awesome/assets/js/20.d995ef93.js"><link rel="prefetch" href="/awesome/assets/js/21.c5ea1d72.js"><link rel="prefetch" href="/awesome/assets/js/22.7ef20e82.js"><link rel="prefetch" href="/awesome/assets/js/23.8c735063.js"><link rel="prefetch" href="/awesome/assets/js/24.64225a74.js"><link rel="prefetch" href="/awesome/assets/js/25.e62bf222.js"><link rel="prefetch" href="/awesome/assets/js/26.6d0152d2.js"><link rel="prefetch" href="/awesome/assets/js/27.f332a9d7.js"><link rel="prefetch" href="/awesome/assets/js/28.c0b718e6.js"><link rel="prefetch" href="/awesome/assets/js/29.ce5c865f.js"><link rel="prefetch" href="/awesome/assets/js/3.f8d5bce8.js"><link rel="prefetch" href="/awesome/assets/js/30.460bd570.js"><link rel="prefetch" href="/awesome/assets/js/31.3713d31c.js"><link rel="prefetch" href="/awesome/assets/js/32.b9a70cd7.js"><link rel="prefetch" href="/awesome/assets/js/33.825a4222.js"><link rel="prefetch" href="/awesome/assets/js/34.e8e4805b.js"><link rel="prefetch" href="/awesome/assets/js/35.a74665ae.js"><link rel="prefetch" href="/awesome/assets/js/36.cb94cb1a.js"><link rel="prefetch" href="/awesome/assets/js/37.9436b911.js"><link rel="prefetch" href="/awesome/assets/js/38.9967cb98.js"><link rel="prefetch" href="/awesome/assets/js/39.9f87d34a.js"><link rel="prefetch" href="/awesome/assets/js/4.6355f2be.js"><link rel="prefetch" href="/awesome/assets/js/40.6313af40.js"><link rel="prefetch" href="/awesome/assets/js/41.cd22a909.js"><link rel="prefetch" href="/awesome/assets/js/42.07fad855.js"><link rel="prefetch" href="/awesome/assets/js/43.d8dcc21b.js"><link rel="prefetch" href="/awesome/assets/js/44.3128db5f.js"><link rel="prefetch" href="/awesome/assets/js/45.d170e6f2.js"><link rel="prefetch" href="/awesome/assets/js/46.093d6209.js"><link rel="prefetch" href="/awesome/assets/js/47.4b98b32f.js"><link rel="prefetch" href="/awesome/assets/js/48.ec4fa22e.js"><link rel="prefetch" href="/awesome/assets/js/49.8b681109.js"><link rel="prefetch" href="/awesome/assets/js/5.4d4c4e48.js"><link rel="prefetch" href="/awesome/assets/js/50.e7f59cf2.js"><link rel="prefetch" href="/awesome/assets/js/51.43480030.js"><link rel="prefetch" href="/awesome/assets/js/52.4eb06a71.js"><link rel="prefetch" href="/awesome/assets/js/53.34f93940.js"><link rel="prefetch" href="/awesome/assets/js/54.466ee0f4.js"><link rel="prefetch" href="/awesome/assets/js/55.24945fb2.js"><link rel="prefetch" href="/awesome/assets/js/56.28af092b.js"><link rel="prefetch" href="/awesome/assets/js/57.73c2970b.js"><link rel="prefetch" href="/awesome/assets/js/58.059f058e.js"><link rel="prefetch" href="/awesome/assets/js/59.0975a796.js"><link rel="prefetch" href="/awesome/assets/js/6.4e514ee6.js"><link rel="prefetch" href="/awesome/assets/js/60.c6526c5f.js"><link rel="prefetch" href="/awesome/assets/js/61.48d584dd.js"><link rel="prefetch" href="/awesome/assets/js/62.2d66cc03.js"><link rel="prefetch" href="/awesome/assets/js/63.c193d358.js"><link rel="prefetch" href="/awesome/assets/js/64.a34e4a8f.js"><link rel="prefetch" href="/awesome/assets/js/65.2c2cfbad.js"><link rel="prefetch" href="/awesome/assets/js/66.b41c703c.js"><link rel="prefetch" href="/awesome/assets/js/67.4c7cecab.js"><link rel="prefetch" href="/awesome/assets/js/68.d3f3c73a.js"><link rel="prefetch" href="/awesome/assets/js/69.a1db6b31.js"><link rel="prefetch" href="/awesome/assets/js/7.f44beaa8.js"><link rel="prefetch" href="/awesome/assets/js/70.8ab3b524.js"><link rel="prefetch" href="/awesome/assets/js/71.b3270458.js"><link rel="prefetch" href="/awesome/assets/js/72.71b97166.js"><link rel="prefetch" href="/awesome/assets/js/73.3de3adc0.js"><link rel="prefetch" href="/awesome/assets/js/74.24e5ed9b.js"><link rel="prefetch" href="/awesome/assets/js/75.4f0abc43.js"><link rel="prefetch" href="/awesome/assets/js/76.81f7f59e.js"><link rel="prefetch" href="/awesome/assets/js/77.c9f211ea.js"><link rel="prefetch" href="/awesome/assets/js/78.9e7cb548.js"><link rel="prefetch" href="/awesome/assets/js/79.acfc6221.js"><link rel="prefetch" href="/awesome/assets/js/8.8e58cfed.js"><link rel="prefetch" href="/awesome/assets/js/80.4275cdc2.js"><link rel="prefetch" href="/awesome/assets/js/81.54e4cb07.js"><link rel="prefetch" href="/awesome/assets/js/82.8508bccc.js"><link rel="prefetch" href="/awesome/assets/js/83.fabb9f38.js"><link rel="prefetch" href="/awesome/assets/js/84.687ad396.js"><link rel="prefetch" href="/awesome/assets/js/85.e5bfb9ea.js"><link rel="prefetch" href="/awesome/assets/js/86.bd2d6261.js"><link rel="prefetch" href="/awesome/assets/js/87.d6861be8.js"><link rel="prefetch" href="/awesome/assets/js/88.7f48bece.js"><link rel="prefetch" href="/awesome/assets/js/89.0f30bfdd.js"><link rel="prefetch" href="/awesome/assets/js/9.6d551784.js"><link rel="prefetch" href="/awesome/assets/js/90.f5890100.js"><link rel="prefetch" href="/awesome/assets/js/91.3fab6936.js"><link rel="prefetch" href="/awesome/assets/js/92.cf56d77d.js"><link rel="prefetch" href="/awesome/assets/js/93.33e15be3.js"><link rel="prefetch" href="/awesome/assets/js/94.0da807b8.js"><link rel="prefetch" href="/awesome/assets/js/95.d1c69105.js"><link rel="prefetch" href="/awesome/assets/js/96.f6ed9d1b.js"><link rel="prefetch" href="/awesome/assets/js/97.43914d57.js"><link rel="prefetch" href="/awesome/assets/js/98.5b052717.js"><link rel="prefetch" href="/awesome/assets/js/99.ad64ce95.js">
    <link rel="stylesheet" href="/awesome/assets/css/0.styles.19f9fd21.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/awesome/" class="home-link router-link-active"><!----> <span class="site-name">Awesome-FE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/awesome/fn.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/awesome/bn.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/awesome/note.html" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/awesome/interview.html" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="https://github.com/Composur" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/awesome/fn.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/awesome/bn.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/awesome/note.html" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/awesome/interview.html" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="https://github.com/Composur" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="移动端兼容处理"><a href="#移动端兼容处理" class="header-anchor">#</a> 移动端兼容处理</h1> <h2 id="基础知识"><a href="#基础知识" class="header-anchor">#</a> 基础知识</h2> <h3 id="webview"><a href="#webview" class="header-anchor">#</a> <strong>Webview</strong></h3> <p><strong>Webview 是一个基于 webkit 的引擎，可以解析 DOM 元素，展示 html 页面的控件，它和浏览器展示页面的原理是相同的，所以可以把它当做浏览器看待。</strong></p> <p><em>chrome 浏览器也是基于 webkit 引擎开发的，Mozilla 浏览器是基于 Gecko 引擎开发的</em></p> <h2 id="html"><a href="#html" class="header-anchor">#</a> HTML</h2> <h5 id="唤醒原生应用"><a href="#唤醒原生应用" class="header-anchor">#</a> 唤醒原生应用</h5> <p>通过<code>location.href</code>与原生应用建立通讯渠道，这种页面与客户端的通讯方式称为<strong>URL Scheme</strong>，其基本格式为<code>scheme://[path][?query]</code></p> <ul><li><strong>scheme</strong>：应用标识，表示应用在系统里的唯一标识</li> <li><strong>path</strong>：应用行为，表示应用某个页面或功能</li> <li><strong>query</strong>：应用参数，表示应用页面或应用功能所需的条件参数</li></ul> <p>例如：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 打开微信 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>weixin://<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>打开微信<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 打开支付宝 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>alipays://<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>打开支付宝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 打开支付宝的扫一扫 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>alipays://platformapi/startapp?saId=10000007<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>打开支付宝的扫一扫<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 打开支付宝的蚂蚁森林 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>alipays://platformapi/startapp?appId=60000002<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>打开支付宝的蚂蚁森林<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h5 id="禁止页面缩放"><a href="#禁止页面缩放" class="header-anchor">#</a> 禁止页面缩放</h5> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="禁止页面缓存"><a href="#禁止页面缓存" class="header-anchor">#</a> 禁止页面缓存</h5> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Cache-Control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>no-cache<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h5 id="自动适应布局"><a href="#自动适应布局" class="header-anchor">#</a> 自动适应布局</h5> <p>通常将<code>rem布局比例</code>设置成<code>1rem=100px</code>，即在设计图上<code>100px</code>长度在CSS代码上使用<code>1rem</code>表示。</p> <p>给HTML上设置 `style=&quot;font-size:xxpx&quot;</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">AutoResponse</span><span class="token punctuation">(</span><span class="token parameter">width <span class="token operator">=</span> <span class="token number">750</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>clientWidth <span class="token operator">&gt;=</span> <span class="token number">600</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token string">&quot;80px&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> target<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> width <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">AutoResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;resize&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">AutoResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>另一种方案：</p> <p>当然还可依据<code>屏幕宽度</code>与<code>设计图宽度</code>的比例使用<code>calc()</code>动态声明<code>&lt;html&gt;</code>的<code>font-size</code></p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">html</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100vw / 7.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>若以<code>iPad Pro</code>分辨率<code>1024px</code>为移动端和桌面端的断点，还可结合<code>媒体查询</code>做断点处理。<code>1024px</code>以下使用<code>rem布局</code>，否则不使用<code>rem布局</code>。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token atrule"><span class="token rule">@media</span> screen and <span class="token punctuation">(</span><span class="token property">max-width</span><span class="token punctuation">:</span> 1024px<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">html</span> <span class="token punctuation">{</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100vw / 7.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="监听屏幕旋转"><a href="#监听屏幕旋转" class="header-anchor">#</a> 监听屏幕旋转</h5> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 横屏 */</span>
<span class="token atrule"><span class="token rule">@media</span> all and <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> landscape<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> 
  
	<span class="token comment">/* 自定义样式 */</span>
  
<span class="token punctuation">}</span>
<span class="token comment">/* 竖屏 */</span>
<span class="token atrule"><span class="token rule">@media</span> all and <span class="token punctuation">(</span><span class="token property">orientation</span><span class="token punctuation">:</span> portrait<span class="token punctuation">)</span></span> <span class="token punctuation">{</span> 
  
 <span class="token comment">/* 自定义样式 */</span>
  
<span class="token punctuation">}</span> 
</code></pre></div><h5 id="支持弹性滚动"><a href="#支持弹性滚动" class="header-anchor">#</a> 支持弹性滚动</h5> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
    <span class="token property">-webkit-overflow-scrolling</span><span class="token punctuation">:</span> touch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.elem</span> <span class="token punctuation">{</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="禁止滚动传播"><a href="#禁止滚动传播" class="header-anchor">#</a> 禁止滚动传播</h5> <p>注意：Safari 暂时不支持</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.elem</span> <span class="token punctuation">{</span>
    <span class="token property">overscroll-behavior</span><span class="token punctuation">:</span> contain<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="美化滚动占位"><a href="#美化滚动占位" class="header-anchor">#</a> 美化滚动占位</h5> <ul><li><strong>::-webkit-scrollbar</strong>：滚动条整体部分</li> <li><strong>::-webkit-scrollbar-track</strong>：滚动条轨道部分</li> <li><strong>::-webkit-scrollbar-thumb</strong>：滚动条滑块部分</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">::-webkit-scrollbar</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 6px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 6px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">::-webkit-scrollbar-track</span> <span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">::-webkit-scrollbar-thumb</span> <span class="token punctuation">{</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token function">linear-gradient</span><span class="token punctuation">(</span>135deg<span class="token punctuation">,</span> #09f<span class="token punctuation">,</span> #3c9<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><h5 id="美化输入占位"><a href="#美化输入占位" class="header-anchor">#</a> 美化输入占位</h5> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">input::-webkit-input-placeholder</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #66f<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="描绘像素边框"><a href="#描绘像素边框" class="header-anchor">#</a> 描绘像素边框</h5> <p>1px</p> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token selector">.elem </span><span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 80px<span class="token punctuation">;</span>
    <span class="token selector"><span class="token parent important">&amp;</span>::after </span><span class="token punctuation">{</span>
        <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
        <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #f66<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 200%<span class="token punctuation">;</span>
        <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span>.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token property">transform-origin</span><span class="token punctuation">:</span> left top<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="控制溢出文本"><a href="#控制溢出文本" class="header-anchor">#</a> 控制溢出文本</h5> <div class="language-scss extra-class"><pre class="language-scss"><code><span class="token selector">.elem </span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
    <span class="token selector"><span class="token parent important">&amp;</span>.sl-ellipsis </span><span class="token punctuation">{</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
        <span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
        <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector"><span class="token parent important">&amp;</span>.ml-ellipsis </span><span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> -webkit-box<span class="token punctuation">;</span>
        <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
        <span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>
        <span class="token property">-webkit-line-clamp</span><span class="token punctuation">:</span> 3<span class="token punctuation">;</span>
        <span class="token property">-webkit-box-orient</span><span class="token punctuation">:</span> vertical<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="禁止点击穿透"><a href="#禁止点击穿透" class="header-anchor">#</a> 禁止点击穿透</h5> <p><a href="https://github.com/ftlabs/fastclick" target="_blank" rel="noopener noreferrer">fastclick<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>有现成的<code>NPM包</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Fastclick <span class="token keyword">from</span> <span class="token string">&quot;fastclick&quot;</span><span class="token punctuation">;</span>

FastClick<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>css方案：</p> <p><code>touch-action</code> 的默为 <code>auto</code>，将其置为 <code>none</code>,即可移除目标元素的 300 毫秒延迟； 缺点: 新属性 ，可能存在浏览器兼容问题</p> <p>使用 <code>touchstart</code> 和 <code>touchend</code> 来模拟代<code>click</code></p> <div class="language-js extra-class"><pre class="language-js"><code>el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;touchstart&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="禁止滑动穿透"><a href="#禁止滑动穿透" class="header-anchor">#</a> 禁止滑动穿透</h5> <ul><li>弹窗打开后内部内容无法滚动</li> <li>弹窗关闭后页面滚动位置丢失</li> <li><code>Webview</code>能上下滑动露出底色</li></ul> <p>css 代码</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body.static</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>js 代码</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token keyword">const</span> openBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;open-btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> closeBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;close-btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
openBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>scrollingElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>
    body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;static&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scrollTop<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
closeBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;static&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="修复高度坍塌"><a href="#修复高度坍塌" class="header-anchor">#</a> 修复高度坍塌</h5> <p>当输入完成键盘占位消失后，页面高度有可能回不到原来高度。</p> <ul><li>页面高度过小</li> <li>输入框在页面底部或视窗中下方</li> <li>输入框聚焦输入文本</li></ul> <p>只要保持前后滚动条偏移量一致就不会出现上述问题。在输入框聚焦时获取页面当前滚动条偏移量，在输入框失焦时赋值页面之前获取的滚动条偏移量，这样就能间接还原页面滚动条偏移量解决页面高度坍塌。</p> <h5 id="简化回到顶部"><a href="#简化回到顶部" class="header-anchor">#</a> 简化回到顶部</h5> <p>函数<a href="https://developer.mozilla.org/zh-cn/docs/web/api/element/scrollintoview" target="_blank" rel="noopener noreferrer">scrollIntoView<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，它会滚动目标元素的父容器使之对用户可见，简单概括就是相对视窗让容器滚动到目标元素位置。它有三个可选参数能让<code>scrollIntoView</code>滚动起来更优雅。</p> <p><strong>behavior</strong>：动画过渡效果，默认<code>auto无</code>，可选<code>smooth平滑</code></p> <p><strong>inline</strong>：水平方向对齐方式，默认<code>nearest就近对齐</code>，可选<code>start顶部对齐</code>、<code>center中间对齐</code>和<code>end底部对齐</code></p> <p><strong>block</strong>：垂直方向对齐方式，默认<code>start顶部对齐</code>，可选<code>center中间对齐</code>、<code>end底部对齐</code>和<code>nearest就近对齐</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> gotopBtn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;gotop-btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
openBtn<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">{</span> behavior<span class="token operator">:</span> <span class="token string">&quot;smooth&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="简化懒性加载"><a href="#简化懒性加载" class="header-anchor">#</a> 简化懒性加载</h5> <p>函数就是<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver" target="_blank" rel="noopener noreferrer">IntersectionObserver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，它提供一种异步观察目标元素及其祖先元素或顶级文档视窗交叉状态的方法。详情可参照<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver" target="_blank" rel="noopener noreferrer">MDN文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>图片懒加载</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>pig.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 很多&lt;img&gt; --&gt;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;img.lazyload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token parameter">nodes</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    nodes<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 判断是否进入可视区域</span>
            v<span class="token punctuation">.</span>target<span class="token punctuation">.</span>src <span class="token operator">=</span> v<span class="token punctuation">.</span>target<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">;</span> <span class="token comment">// 赋值加载图片</span>
            observer<span class="token punctuation">.</span><span class="token function">unobserve</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 停止监听已加载的图片</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p><strong>下拉加载</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 很多&lt;li&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 也可将#bottom以&lt;li&gt;的形式插入到&lt;ul&gt;内部的最后位置 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>bottom<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> bottom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;bottom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IntersectionObserver</span><span class="token punctuation">(</span><span class="token parameter">nodes</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> tgt <span class="token operator">=</span> nodes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 反正只有一个</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tgt<span class="token punctuation">.</span>isIntersecting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;已到底部，请求接口&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 执行接口请求代码</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="元素的高度"><a href="#元素的高度" class="header-anchor">#</a> 元素的高度</h3> <ul><li><code>clientHeight</code> : 可理解为内部可视区高度，样式的 <code>height</code> +  <code>padding</code></li> <li><code>scrollHeight</code> 网页正文全文高</li> <li><code>offsetHeight</code> 网页可见区域高 ，元素的<code>height</code> + <code>padding</code> + <code>border</code>+ 水平滚动条</li> <li><code>scrollTop</code> 页面被卷上去的高度</li> <li></li></ul> <h3 id="键盘弹出"><a href="#键盘弹出" class="header-anchor">#</a> 键盘弹出</h3> <p>IOS：IOS 的键盘处在窗口的最上层，当键盘弹起时，webview 的高度 height 并没有改变，只是 scrollTop 发生变化，页面可以滚动。且页面可以滚动的最大限度为弹出的键盘的高度，而只有键盘弹出时页面恰好也滚动到最底部时，scrollTop 的变化值为键盘的高度，其他情况下则无法获取。这就导致在 IOS 情况下难以获取键盘的真实高度。</p> <p>Android: webview 中留出空间，该空间小于等于的键盘空间，变化的高度差会随着布局而不同，有的认为 <code>键盘高度 + 页面高度 = 原页面高度；</code> 是错误的误导，只有在某种很巧合的布局情况下才可套用此公式。</p> <h3 id="键盘收起"><a href="#键盘收起" class="header-anchor">#</a> 键盘收起</h3> <p>IOS：触发键盘上的按钮收起键盘或者输入框以外的页面区域时，输入框会失去焦点，因此会触发输入框的 blur 事件。</p> <p>Android: 触发键盘上的按钮收起键盘时，输入框并不会失去焦点，因此不会触发页面的 blur 事件；触发输入框以外的区域时，输入框会失去焦点，触发输入框的 blur 事件。</p> <h3 id="监听键盘的弹出与收起"><a href="#监听键盘的弹出与收起" class="header-anchor">#</a> 监听键盘的弹出与收起</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ua <span class="token operator">=</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLocaleLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isIOS <span class="token operator">=</span> <span class="token regex">/iphone|ipad|ipod/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>ua<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isAndroid <span class="token operator">=</span> <span class="token regex">/android/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>ua<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// ios &amp; android 键盘弹出：</span>
<span class="token keyword">const</span> $input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'focus'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// 处理键盘弹出后所需的页面逻辑</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ios 键盘收起：</span>
<span class="token keyword">const</span> $input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'blur'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// 处理键盘收起后所需的页面逻辑</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*键盘弹起后页面高度变小*/</span>
<span class="token keyword">const</span> originHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> resizeHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>resizeHeight <span class="token operator">&lt;</span> originHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 键盘弹起所后所需的页面逻辑</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token comment">// 键盘弹起所后所需的页面逻辑</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre></div><h2 id="ios-键盘输入确认搜索后键盘不消失"><a href="#ios-键盘输入确认搜索后键盘不消失" class="header-anchor">#</a> IOS 键盘输入确认搜索后键盘不消失</h2> <p>解决办法：<code>input</code> 提交的时候触发  <code>blur</code> 事件，让 <code>input</code> 失去焦点。</p> <h2 id="移动端底部-input-被弹出的键盘遮挡"><a href="#移动端底部-input-被弹出的键盘遮挡" class="header-anchor">#</a> 移动端底部 input 被弹出的键盘遮挡</h2> <p>最新版的 iOS 没有这个问题，为了兼容老系统。</p> <p>下面方法二选一就行：</p> <p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollIntoView" target="_blank" rel="noopener noreferrer">Element.scrollIntoView()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:方法<strong>让当前的元素滚动到浏览器窗口的可视区域内</strong>。</p> <p>:<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollIntoViewIfNeeded" target="_blank" rel="noopener noreferrer">Element.scrollIntoViewIfNeeded()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ：方法<strong>用来将不在浏览器窗口的可见区域内的元素滚动到浏览器窗口的可见区域</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#inputId'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//只要在input的点击事件，或者获取焦点的事件中，加入这个api就好了</span>
</code></pre></div><h2 id="ios-safari浏览器上overflow-scroll元素无法滚动"><a href="#ios-safari浏览器上overflow-scroll元素无法滚动" class="header-anchor">#</a> <a href="https://segmentfault.com/a/1190000016408566" target="_blank" rel="noopener noreferrer">iOS safari浏览器上overflow: scroll元素无法滚动<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>**问题描述：**当 iOS safari 浏览器上出现大于父容器的子元素，想给父容器加上<code>overflow: scroll</code>实现内部滚动效果而失败。</p> <p><strong>剖析：</strong> safari浏览器在渲染页面元素的时候，会预先走webkit浏览器的渲染流程：</p> <ol><li>构建DOM tree</li> <li>构建CSS rule tree</li> <li>根据DOM和CSS tree来构建render tree</li> <li>根据render tree计算页面的layout</li> <li>render页面</li></ol> <p>在第三步和第四步的时候，safari浏览器在构建render tree的时候，会预先找到相应的<code>overflow: scroll</code>元素，在计算页面layout的时候，会计算父元素的高度与子元素的高度，若子元素高于父元素，则在<strong>render页面时为其建立一个原生的scrollView。</strong></p> <p>这个scrollView有什么用的？其实就是为了给其一个弹弹乐的效果（但确实用户体验不错）。</p> <p>当子元素是某个媒体格式时，比如img、object（svg）等，safari在加载完成之前是不会在计算在layout之内的，也就是高度为0，<strong>则子元素的高度就一定小于父元素的高度，safari不会给父元素一个原生的scrollView。</strong></p> <h3 id="解决办法"><a href="#解决办法" class="header-anchor">#</a> 解决办法：</h3> <p>方法一：给子元素一个包裹元素，包裹元素设置一个min-height大于父元素的高度，让父元素有scrollView。当子元素加载完成时，将包裹元素撑开，父元素便可以自由滚动了。<small>不一定成功</small></p> <p>方法二：通过 <code>document.addEventListener(&quot;scroll&quot;, this.onScroll, true);</code> 监听</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 以上拉刷新举例 </span>
<span class="token function">onScroll</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> clientHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span> 
    <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span> 
    <span class="token keyword">var</span> scrollHeight <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">;</span> 
	<span class="token comment">// </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>clientHeight <span class="token operator">+</span> scrollTop <span class="token operator">+</span> <span class="token number">20</span> <span class="token operator">&gt;=</span> scrollHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bottomCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p><strong>浏览器视口</strong></p> <ul><li>布局视口，原始视口也就是原始的 width ，<code>document.documentElement.clientWidth</code></li> <li>视觉视口，用户看到的真实区域，它决定了用户能够看到多少东西，<code>window.innerWidth</code></li> <li>理想视口，网页在移动端展示的最佳大小，<code>window.innerWidth</code></li></ul> <p>通常网页上的</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>上面的 <code>width=device-width, initial-scale=1, maximum-scale=1</code> 的目的在于让三者统一，</p> <p>即：<code>布局视口 = 视觉视口 = 理想视口</code></p> <h2 id="scroll-事件失效"><a href="#scroll-事件失效" class="header-anchor">#</a> scroll 事件失效</h2> <p>**问题描述：**在<code>Vue</code>中的组件绑定<code>scroll</code>事件，事件处理函数似乎不会触发。</p> <h3 id="前置知识-javascript事件模型"><a href="#前置知识-javascript事件模型" class="header-anchor">#</a> 前置知识 JavaScript事件模型</h3> <p><img src="/awesome/assets/img/capture-bubble-phase.70a9419f.png" alt="capture-bubble-phase"></p> <ul><li>捕获阶段
<ul><li>事件从<code>document</code>到传递到目标元素的过程</li></ul></li> <li>冒泡阶段
<ul><li>事件从目标元素传递到<code>document</code>的过程</li></ul></li></ul> <p>我们一般监听事件的冒泡阶段：<code>elem.addEventListener('scroll', handler,false)</code></p> <p><code>addEventListener</code>第三个参数可能值:</p> <ul><li>true - 事件句柄在捕获阶段执行</li> <li>false- false- 默认。事件句柄在冒泡阶段执行</li></ul> <h3 id="失效原因"><a href="#失效原因" class="header-anchor">#</a> 失效原因</h3> <p>** <code>element</code>的<code>scroll</code>事件<strong>不冒泡</strong>, 但是<code>document</code>的<code>defaultView</code>的<code>scroll</code>事件冒泡。**</p> <p>如果<code>scroll</code>的目标元素是一个元素的话，比如说是一个<code>div</code>元素。那么此时事件只有从<code>document</code>到<code>div</code>的捕获阶段以及<code>div</code>的冒泡阶段。如果尝试在父级监视<code>scroll</code>的冒泡阶段监视这一事件是无效的。如果<code>scroll</code>是由<code>document.defaultView</code>（目前<code>document</code>关联的<code>window</code>对象）产生的有冒泡阶段。但是由于其本身就是DOM树里最顶级的对象，因此只能在<code>window</code>里监视<code>scroll</code>的捕获阶段以及冒泡阶段。</p> <p><img src="/awesome/assets/img/scroll-event-flow.e4287fb9.png" alt="scroll-event-flow"></p> <p>如图所示在目标元素的父级监听是监听不到的。因为只冒泡到了他自己上就断了，不往上冒泡了。</p> <h3 id="解决办法-2"><a href="#解决办法-2" class="header-anchor">#</a> <strong>解决办法：</strong></h3> <p>方法一：要确定目标元素是谁，谁产生了<code>scroll</code>事件，是谁就在谁上进行监听。</p> <p>方法二：就是在<code>window</code>上监听<code>scroll</code>的捕获阶段，即<code>window.addEventListener('scroll', handler, true)</code></p> <h2 id="new-date-的兼容性-ios"><a href="#new-date-的兼容性-ios" class="header-anchor">#</a> new Date 的兼容性 iOS</h2> <p><strong>问题描述：使用new Date(time).getTime() 方法转换时间戳。iOS 获取不到。</strong></p> <h3 id="解决办法-3"><a href="#解决办法-3" class="header-anchor">#</a> 解决办法</h3> <p>格式一：</p> <p>2018-03-05 00:00:02 如果 <code>time</code> 是这种格式，需要把 “-” 转换成 <code>“/” str.replace(/-/g,&quot;/&quot;)</code></p> <p>格式二：</p> <p>2018-03-05 00:00:02.55  这种截取前19位str.substring(0,19) 进行转换。</p> <h2 id="吸顶的写法"><a href="#吸顶的写法" class="header-anchor">#</a> 吸顶的写法</h2> <h3 id="粘性定位"><a href="#粘性定位" class="header-anchor">#</a> 粘性定位</h3> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.sticky</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> sticky<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>必须指定 top、right、bottom、left 四个阈值的其中之一，粘性定位才会生效。</li> <li>父容器的高度，应大于粘性定位的元素，粘性布局是对父级滚动元素定位。</li></ul> <h3 id="粘性事件"><a href="#粘性事件" class="header-anchor">#</a> 粘性事件</h3> <p>浏览器暂无提供粘性定位事件，可以用模拟的方式。</p> <p>监听 scroll 事件，获取目标元素的信息<code>boundingClientRect</code>，和设定的值进行比较，然后触发自定义事件。</p> <h2 id="兼容-iphone-x-刘海屏-底部显示"><a href="#兼容-iphone-x-刘海屏-底部显示" class="header-anchor">#</a> 兼容 iPhone X 刘海屏 底部显示</h2> <p>第一步：设置网页在可视窗口的布局方式</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>viewport<span class="token punctuation">'</span></span>  <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, viewport-fit=cover<span class="token punctuation">&quot;</span></span>  <span class="token punctuation">/&gt;</span></span>
</code></pre></div><p>第二步：页面主体内容限定在安全区域内</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 适配齐刘海*/</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-top<span class="token punctuation">)</span><span class="token punctuation">;</span>  
 <span class="token comment">/* 适配底部黑条*/</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>fixed 元素的适配</p> <p>bottom 不是0的情况</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* bottom 不是0的情况 */</span>
<span class="token selector">.fixed</span> <span class="token punctuation">{</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">50px</span><span class="token punctuation">(</span>原来的bottom值<span class="token punctuation">)</span> + <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>吸底的情况（bottom=0）</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/* 方法1 ：设置内边距 扩展高度*/</span>
<span class="token comment">/* 这个方案需要吸底条必须是有背景色的，因为扩展的部分背景是跟随外容器的，否则出现镂空情况。*/</span>
<span class="token selector">.fix</span> <span class="token punctuation">{</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 直接扩展高度*/</span>
<span class="token selector">.fix</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token function">60px</span><span class="token punctuation">(</span>原来的高度值<span class="token punctuation">)</span> + <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 方法2 ：在元素下面用一个空div填充， 但是背景色要一致 */</span>
<span class="token selector">.blank</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/* 吸底元素样式 */</span>
<span class="token selector">.fix</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>第三步：使用 <code>@supports</code></p> <div class="language-scss extra-class"><pre class="language-scss"><code>@supports <span class="token punctuation">(</span><span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token selector">body </span><span class="token punctuation">{</span>
    <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>完整 <code>less</code></p> <div class="language-less extra-class"><pre class="language-less"><code><span class="token atrule">@mixin iphonex-css</span> <span class="token punctuation">{</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>top<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//为导航栏+状态栏的高度 88px</span>
  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>top<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//为导航栏+状态栏的高度 88px</span>
  <span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果未竖屏时为0</span>
  <span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果未竖屏时为0</span>
  <span class="token property">padding-right</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果未竖屏时为0</span>
  <span class="token property">padding-right</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//如果未竖屏时为0</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//为底下圆弧的高度 34px</span>
  <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe<span class="token operator">-</span>area<span class="token operator">-</span>inset<span class="token operator">-</span>bottom<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//为底下圆弧的高度 34px</span>
<span class="token punctuation">}</span>

<span class="token comment">/* iphonex 适配 */</span>
<span class="token atrule">@mixin iphonex-media</span> <span class="token punctuation">{</span>
  <span class="token atrule">@media only screen and <span class="token punctuation">(</span>device-width<span class="token punctuation">:</span> 375px<span class="token punctuation">)</span> and <span class="token punctuation">(</span>device-height<span class="token punctuation">:</span> 812px<span class="token punctuation">)</span> and <span class="token punctuation">(</span>-webkit-device-pixel-ratio<span class="token punctuation">:</span> 3<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    <span class="token selector">body.iphonex</span> <span class="token punctuation">{</span>
      <span class="token variable">@include</span> iphonex<span class="token operator">-</span>css<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="ios垂直居中不生效"><a href="#ios垂直居中不生效" class="header-anchor">#</a> iOS垂直居中不生效</h2> <p>Safari中必须设置 父元素 <code>position:relative</code></p> <h2 id="上拉下拉有空白"><a href="#上拉下拉有空白" class="header-anchor">#</a> 上拉下拉有空白</h2> <p>在 iOS 中，手指按住屏幕上下拖动，会触发 <code>touchmove</code> 事件。这个事件触发的对象是整个 <code>webview</code> 容器 ，容器自然会被拖动，剩下的部分会成空白。</p> <p>解决方案：</p> <p>1、<code>preventDefault</code> 方法，阻止同一触点上所有默认行为，包括滚动。 通过监听 <code>touchmove</code>，让需要滑动的地方滑动，不需要滑动的地方禁止滑动注意要过滤掉具有滚动容器的元素。</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchmove'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>_isScroller<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token comment">// 阻止默认事件</span>
    e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    passive<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>2、填充空白， 装饰成其他功能，或者设置背景图。</p> <h2 id="生成图片"><a href="#生成图片" class="header-anchor">#</a> 生成图片</h2> <p>1、 生成画布</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> html2canvas <span class="token keyword">from</span> <span class="token string">'html2canvas'</span><span class="token punctuation">;</span>

<span class="token function">html2canvas</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>2、上述生成的图片较为模糊，生成多倍图</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 根据需要设置 scaleSize 大小</span>
<span class="token keyword">const</span> scaleSize <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> target <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span>width<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> height <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
newCanvas<span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">*</span> scaleSize<span class="token punctuation">;</span>
newCanvas<span class="token punctuation">.</span>height <span class="token operator">=</span> height <span class="token operator">*</span> scaleSize<span class="token punctuation">;</span>
newCanvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> width <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
newCanvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> height <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> newCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span>scaleSize<span class="token punctuation">,</span> scaleSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">html2canvas</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.demo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> canvas<span class="token operator">:</span> newCanvas <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 简单的通过超链接设置下载功能</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.btn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/awesome/assets/js/app.25e7e7c5.js" defer></script><script src="/awesome/assets/js/2.b179fbd3.js" defer></script><script src="/awesome/assets/js/14.be50f30a.js" defer></script>
  </body>
</html>
