<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack | Awesome-FE</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="个人笔记">
    
    <link rel="preload" href="/awesome/assets/css/0.styles.b7f07938.css" as="style"><link rel="preload" href="/awesome/assets/js/app.eb163c09.js" as="script"><link rel="preload" href="/awesome/assets/js/2.4fcc29d0.js" as="script"><link rel="preload" href="/awesome/assets/js/108.0a81d75c.js" as="script"><link rel="prefetch" href="/awesome/assets/js/10.5ee9393c.js"><link rel="prefetch" href="/awesome/assets/js/100.028c316f.js"><link rel="prefetch" href="/awesome/assets/js/101.6e418b33.js"><link rel="prefetch" href="/awesome/assets/js/102.8559b54f.js"><link rel="prefetch" href="/awesome/assets/js/103.5fcea2ac.js"><link rel="prefetch" href="/awesome/assets/js/104.5b75efaa.js"><link rel="prefetch" href="/awesome/assets/js/105.c4ead6ec.js"><link rel="prefetch" href="/awesome/assets/js/106.e1d61134.js"><link rel="prefetch" href="/awesome/assets/js/107.f8ca1fb1.js"><link rel="prefetch" href="/awesome/assets/js/109.28c204ee.js"><link rel="prefetch" href="/awesome/assets/js/11.f1625247.js"><link rel="prefetch" href="/awesome/assets/js/110.6a5ca3e4.js"><link rel="prefetch" href="/awesome/assets/js/12.935e8943.js"><link rel="prefetch" href="/awesome/assets/js/13.553d1313.js"><link rel="prefetch" href="/awesome/assets/js/14.231f236e.js"><link rel="prefetch" href="/awesome/assets/js/15.2d8b1237.js"><link rel="prefetch" href="/awesome/assets/js/16.67835925.js"><link rel="prefetch" href="/awesome/assets/js/17.7ffe9ed1.js"><link rel="prefetch" href="/awesome/assets/js/18.97355e14.js"><link rel="prefetch" href="/awesome/assets/js/19.1d6060d2.js"><link rel="prefetch" href="/awesome/assets/js/20.111866e5.js"><link rel="prefetch" href="/awesome/assets/js/21.84a5a38d.js"><link rel="prefetch" href="/awesome/assets/js/22.e9c5ebc4.js"><link rel="prefetch" href="/awesome/assets/js/23.e9c824b5.js"><link rel="prefetch" href="/awesome/assets/js/24.88b7fd64.js"><link rel="prefetch" href="/awesome/assets/js/25.c8c15ada.js"><link rel="prefetch" href="/awesome/assets/js/26.b1067515.js"><link rel="prefetch" href="/awesome/assets/js/27.5792cb25.js"><link rel="prefetch" href="/awesome/assets/js/28.784f758f.js"><link rel="prefetch" href="/awesome/assets/js/29.e8113ee2.js"><link rel="prefetch" href="/awesome/assets/js/3.e8b1b2fa.js"><link rel="prefetch" href="/awesome/assets/js/30.039fa653.js"><link rel="prefetch" href="/awesome/assets/js/31.f08ce2ae.js"><link rel="prefetch" href="/awesome/assets/js/32.536b8f8e.js"><link rel="prefetch" href="/awesome/assets/js/33.f2374e7c.js"><link rel="prefetch" href="/awesome/assets/js/34.f73c849f.js"><link rel="prefetch" href="/awesome/assets/js/35.4559815c.js"><link rel="prefetch" href="/awesome/assets/js/36.39f61847.js"><link rel="prefetch" href="/awesome/assets/js/37.b6c2d611.js"><link rel="prefetch" href="/awesome/assets/js/38.370226ec.js"><link rel="prefetch" href="/awesome/assets/js/39.f7cec98c.js"><link rel="prefetch" href="/awesome/assets/js/4.6906b047.js"><link rel="prefetch" href="/awesome/assets/js/40.02e232d5.js"><link rel="prefetch" href="/awesome/assets/js/41.8874042b.js"><link rel="prefetch" href="/awesome/assets/js/42.5263c8dc.js"><link rel="prefetch" href="/awesome/assets/js/43.e04c954c.js"><link rel="prefetch" href="/awesome/assets/js/44.1b7682b2.js"><link rel="prefetch" href="/awesome/assets/js/45.ab92c1df.js"><link rel="prefetch" href="/awesome/assets/js/46.db7842e2.js"><link rel="prefetch" href="/awesome/assets/js/47.8b500396.js"><link rel="prefetch" href="/awesome/assets/js/48.c6f99e5e.js"><link rel="prefetch" href="/awesome/assets/js/49.5f885564.js"><link rel="prefetch" href="/awesome/assets/js/5.a33ef64a.js"><link rel="prefetch" href="/awesome/assets/js/50.0503b014.js"><link rel="prefetch" href="/awesome/assets/js/51.dd3280bb.js"><link rel="prefetch" href="/awesome/assets/js/52.49823c83.js"><link rel="prefetch" href="/awesome/assets/js/53.274e23f6.js"><link rel="prefetch" href="/awesome/assets/js/54.bc7176c9.js"><link rel="prefetch" href="/awesome/assets/js/55.3f1c58a8.js"><link rel="prefetch" href="/awesome/assets/js/56.6f0b783d.js"><link rel="prefetch" href="/awesome/assets/js/57.d169b38f.js"><link rel="prefetch" href="/awesome/assets/js/58.16afb427.js"><link rel="prefetch" href="/awesome/assets/js/59.9185c2d1.js"><link rel="prefetch" href="/awesome/assets/js/6.d4452fbc.js"><link rel="prefetch" href="/awesome/assets/js/60.adcce7b8.js"><link rel="prefetch" href="/awesome/assets/js/61.0ff7a3fa.js"><link rel="prefetch" href="/awesome/assets/js/62.7f15c3de.js"><link rel="prefetch" href="/awesome/assets/js/63.2c5057e6.js"><link rel="prefetch" href="/awesome/assets/js/64.6be75d22.js"><link rel="prefetch" href="/awesome/assets/js/65.a0b653b9.js"><link rel="prefetch" href="/awesome/assets/js/66.1fdb3c3e.js"><link rel="prefetch" href="/awesome/assets/js/67.6cbd2193.js"><link rel="prefetch" href="/awesome/assets/js/68.2fb5dfd2.js"><link rel="prefetch" href="/awesome/assets/js/69.8941df98.js"><link rel="prefetch" href="/awesome/assets/js/7.8894017d.js"><link rel="prefetch" href="/awesome/assets/js/70.2c5a0bea.js"><link rel="prefetch" href="/awesome/assets/js/71.ed08e19d.js"><link rel="prefetch" href="/awesome/assets/js/72.dcb68771.js"><link rel="prefetch" href="/awesome/assets/js/73.cabad167.js"><link rel="prefetch" href="/awesome/assets/js/74.8d773a20.js"><link rel="prefetch" href="/awesome/assets/js/75.720bdb3f.js"><link rel="prefetch" href="/awesome/assets/js/76.ba52cba7.js"><link rel="prefetch" href="/awesome/assets/js/77.ab901c9e.js"><link rel="prefetch" href="/awesome/assets/js/78.48a08731.js"><link rel="prefetch" href="/awesome/assets/js/79.5935ce86.js"><link rel="prefetch" href="/awesome/assets/js/8.a016d72e.js"><link rel="prefetch" href="/awesome/assets/js/80.2cd79103.js"><link rel="prefetch" href="/awesome/assets/js/81.5c4d205f.js"><link rel="prefetch" href="/awesome/assets/js/82.2eb857e5.js"><link rel="prefetch" href="/awesome/assets/js/83.240f740d.js"><link rel="prefetch" href="/awesome/assets/js/84.d2282657.js"><link rel="prefetch" href="/awesome/assets/js/85.ac29c610.js"><link rel="prefetch" href="/awesome/assets/js/86.76a92f8a.js"><link rel="prefetch" href="/awesome/assets/js/87.c744b446.js"><link rel="prefetch" href="/awesome/assets/js/88.0ab4fbde.js"><link rel="prefetch" href="/awesome/assets/js/89.b7b8e8e5.js"><link rel="prefetch" href="/awesome/assets/js/9.36f3b8fe.js"><link rel="prefetch" href="/awesome/assets/js/90.121eeddd.js"><link rel="prefetch" href="/awesome/assets/js/91.eada99a5.js"><link rel="prefetch" href="/awesome/assets/js/92.19ab7601.js"><link rel="prefetch" href="/awesome/assets/js/93.2d994515.js"><link rel="prefetch" href="/awesome/assets/js/94.86edc9c3.js"><link rel="prefetch" href="/awesome/assets/js/95.7445edd3.js"><link rel="prefetch" href="/awesome/assets/js/96.03ff4a34.js"><link rel="prefetch" href="/awesome/assets/js/97.c36ff2bb.js"><link rel="prefetch" href="/awesome/assets/js/98.78b97078.js"><link rel="prefetch" href="/awesome/assets/js/99.5a25b18a.js">
    <link rel="stylesheet" href="/awesome/assets/css/0.styles.b7f07938.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/awesome/" class="home-link router-link-active"><!----> <span class="site-name">Awesome-FE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/awesome/fn.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/awesome/bn.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/awesome/note.html" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/awesome/interview.html" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="https://github.com/Composur" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/awesome/fn.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/awesome/bn.html" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/awesome/note.html" class="nav-link">
  笔记
</a></div><div class="nav-item"><a href="/awesome/interview.html" class="nav-link">
  面试
</a></div><div class="nav-item"><a href="https://github.com/Composur" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#" class="sidebar-link">/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#vue" class="sidebar-link">Vue</a></li></ul></li><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#处理-img-加载失败" class="sidebar-link">处理 img 加载失败</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#bus-event-on-无效" class="sidebar-link">bus.$event.$on 无效</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#页面间-ifream-通信-postmessage" class="sidebar-link">页面间（ifream）通信 PostMessage</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#vue-table-修改的问题" class="sidebar-link">vue table 修改的问题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#vue-刷新当前页面" class="sidebar-link">Vue 刷新当前页面</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#显示隐藏router-view" class="sidebar-link">显示隐藏router-view</a></li><li class="sidebar-sub-header"><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#重定向到空组件在replace" class="sidebar-link">重定向到空组件在replace</a></li><li class="sidebar-sub-header"><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#实用-api" class="sidebar-link">实用 API</a></li></ul></li><li><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#intersectionobserver" class="sidebar-link">IntersectionObserver</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/awesome/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98.html#清除定时器后置为null" class="sidebar-link">清除定时器后置为null</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack"><a href="#webpack" class="header-anchor">#</a> webpack</h1> <h3 id="代码检查"><a href="#代码检查" class="header-anchor">#</a> 代码检查</h3> <ul><li><p>加入 <code>eslint</code></p></li> <li><p>加入 <code>stylelint</code></p> <ul><li><p>配置一些</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'defaultSeverity'</span><span class="token operator">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span>
  <span class="token string-property property">'extends'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'stylelint-config-standard'</span><span class="token punctuation">,</span> <span class="token string">'stylelint-config-recommended-scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">'plugins'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'stylelint-scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">'rules'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不要使用已被 autoprefixer 支持的浏览器前缀</span>
    <span class="token string-property property">'media-feature-name-no-vendor-prefix'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">'at-rule-no-vendor-prefix'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">'selector-no-vendor-prefix'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">'property-no-vendor-prefix'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token string-property property">'value-no-vendor-prefix'</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div></li> <li><p><code>.stylelintcache</code> 方便开发编译，开启后自动生成</p></li></ul></li> <li><p>配置全局指令</p></li></ul> <h3 id="自动-require-图片"><a href="#自动-require-图片" class="header-anchor">#</a> 自动 require 图片</h3> <p>以前在写 Vue 的时候经常会写到这样的代码：把图片提前 require 传给一个变量再传给组件</p> <div class="language-vue extra-class"><pre class="language-vue"><code>// page 代码
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>avatar</span> <span class="token attr-name">:img-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imgSrc<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>avatar</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>imgSrc <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./assets/default-avatar.png'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p>通过配置 transformAssetUrls 后，就可以直接配置，这样vue-loader会把对应的属性自动 require 之后传给组件</p> <div class="language-js extra-class"><pre class="language-js"><code>config<span class="token punctuation">.</span>module
  <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'vue-loader'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">'vue-loader'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token parameter">options</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 默认为 true</span>
  <span class="token comment">// 这意味着编译好的渲染函数会保留所有 HTML 标签之间的空格。如果设置为 false，则标签之间的空格会被忽略。这能够略微提升一点性能但是可能会影响到内联元素的布局。</span>
  options<span class="token punctuation">.</span>compilerOptions<span class="token punctuation">.</span>preserveWhitespace <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token comment">// 可以在组件中这样引入图片</span>
  <span class="token comment">//  &lt;avatar img-src=&quot;./assets/default-avatar.png&quot;&gt;&lt;/avatar&gt;</span>
  <span class="token comment">// 等价于 require('xxx.png')</span>
  options<span class="token punctuation">.</span>transformAssetUrls <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">avatar</span><span class="token operator">:</span> <span class="token string">'img-src'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> options
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="压缩图片"><a href="#压缩图片" class="header-anchor">#</a> 压缩图片</h3> <blockquote><p>image-webpack-loader</p> <p>将大的图片进行压缩从而缩小打包体积</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// ============压缩图片 start============</span>
        config<span class="token punctuation">.</span>module
            <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">'images'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'image-webpack-loader'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span><span class="token string">'image-webpack-loader'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">bypassOnDebug</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// ============压缩图片 end============</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// webpack.base.config.js</span>
<span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(gif|png|jpe?g|svg)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
  <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 因为用了 url-loader 要先写 file-loader 不然图片出不来</span>
    <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'image-webpack-loader'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">bypassOnDebug</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// webpack@1.x</span>
        <span class="token literal-property property">disable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// webpack@2.x and newer</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="配置-webpack-打包依赖库使用-commonjs"><a href="#配置-webpack-打包依赖库使用-commonjs" class="header-anchor">#</a> 配置 webpack 打包依赖库使用 CommonJS</h3> <p>在项目的<code>babel.config.js</code>中写下如下的配置就可以了：</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
  <span class="token operator">...</span>
  <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">[</span> 
    <span class="token punctuation">{</span>    
      <span class="token comment">// 使用的第三方库</span>
      <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token string">'./node_modules/module-name/library-name/name.common.js'</span><span class="token punctuation">,</span>        			sourceType<span class="token operator">:</span> <span class="token string">'unambiguous'</span> 
    <span class="token punctuation">}</span>  
  <span class="token punctuation">]</span><span class="token punctuation">,</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="编译打包失败-内存溢出"><a href="#编译打包失败-内存溢出" class="header-anchor">#</a> 编译打包失败，内存溢出</h3> <p><strong>问题描述</strong>：本机打包没问题，服务器打包出错，出错信息为内存溢出，Node内存不足所导致。</p> <p><strong>Node 中通过 JavaScript 使用内存时只能使用部分内存（64位系统下约为1.4 GB，32位系统下约为0.7 GB）</strong></p> <p>初步想法：<code>require.context(xx,true,/js/)</code>，递归某个层级很深的文件夹导致。因为暂时无法调整 node 编译内存大小。</p> <p>没办法只能调整 4G了：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node --max_old_space_size=4096 build/build.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id=""><a href="#" class="header-anchor">#</a></h2> <h1 id="vue"><a href="#vue" class="header-anchor">#</a> Vue</h1> <p><code>Vue.config.errorHandler</code> 捕获声明周期、自定义事件处理函数内部、<code>v-on DOM</code> 监听器内部抛出的错误，避免应用崩溃，也可以进行错误上报。</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">errorHandler</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> info</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// `info` 是 Vue 特定的错误信息，比如错误所在的生命周期钩子</span>
  <span class="token comment">// 进行错误上报</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>Vue.config.warnHandler</code> 为 Vue 的运行时警告赋予一个自定义处理函数,只会在开发者环境下生效</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">warnHandler</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">msg<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> trace</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// `trace` 是组件的继承关系追踪</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="处理-img-加载失败"><a href="#处理-img-加载失败" class="header-anchor">#</a> 处理 img 加载失败</h2> <div class="language-vue extra-class"><pre class="language-vue"><code>// page 代码
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imgUrl<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@error</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleError<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">{</span>
      <span class="token literal-property property">imgUrl</span><span class="token operator">:</span><span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">handleError</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>src<span class="token operator">=</span><span class="token function">reqiure</span><span class="token punctuation">(</span><span class="token string">'图片路径'</span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h2 id="bus-event-on-无效"><a href="#bus-event-on-无效" class="header-anchor">#</a> bus.$event.$on 无效</h2> <blockquote><p>https://juejin.im/post/6844903591216414728</p></blockquote> <p><strong>问题描述：</strong></p> <p><strong>从一个页面跳转到另一个页面去选择一些信息，选择好后返回上一个页面，并把选择的信息带过来</strong></p> <p>A 组件</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">this</span><span class="token punctuation">.</span>$eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
</code></pre></div><p>B 组件</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">this</span><span class="token punctuation">.</span>$eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>data<span class="token punctuation">)</span>
</code></pre></div><p>但是 B 组件没有监听到事件</p> <p>在路由切换时，执行的方法依次是：</p> <ul><li><p>新组件： <code>beforeCreate</code></p></li> <li><p>新组件： <code>created</code></p></li> <li><p>新组件： <code>beforeMount</code></p></li> <li><p>旧组件： <code>beforeDestroy</code></p></li> <li><p>旧组件：<code>destroyed</code></p></li> <li><p>新组件： <code>mounted</code></p></li></ul> <p>B 组件需要在 A 组件销毁前。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">destroyed</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span>$eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'eventName'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="页面间-ifream-通信-postmessage"><a href="#页面间-ifream-通信-postmessage" class="header-anchor">#</a> 页面间（ifream）通信 PostMessage</h2> <p>假设有 a、b、c 三个页面，需要进行跨域，跨窗口消息传递</p> <p>a 页面传递信息给 c</p> <p>b 可以操作传递给 c 的信息，增删改查</p> <p>a.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>A-页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">#child</span> <span class="token punctuation">{</span>
            <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>A-页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Key<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>输入key<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemKey<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Value<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>输入value<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>add<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>添加<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>child<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:5500/src/local_cross/c.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">var</span> add <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        add<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> itemKey <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;itemKey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">var</span> itemValue <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;itemValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>itemKey <span class="token operator">&amp;&amp;</span> itemValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                window<span class="token punctuation">.</span>frames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">key</span><span class="token operator">:</span> itemKey<span class="token punctuation">,</span>
                    <span class="token literal-property property">value</span><span class="token operator">:</span> itemValue
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'添加成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请输入key或者value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>c.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>C-页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>C-页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">win</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            win<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">evt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">debugger</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">.</span>parent <span class="token operator">!=</span> evt<span class="token punctuation">.</span>source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>evt<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">var</span> data <span class="token operator">=</span> win<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    win<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&quot;set&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    win<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>key<span class="token punctuation">,</span> options<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&quot;remove&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    win<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">&quot;clear&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    win<span class="token punctuation">.</span>localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>b.html</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ie=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>B-页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
        <span class="token selector">#child</span> <span class="token punctuation">{</span>
            <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>B-页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Key<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>输入key<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemKey<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>获取<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>itemValue<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>child<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:5500/src/local_cross/c.html<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">var</span> getValue <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;getValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        getValue<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> itemKey <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;itemKey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">var</span> itemValue <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;itemValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>itemKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                window<span class="token punctuation">.</span>frames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">key</span><span class="token operator">:</span> itemKey
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>origin <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span>origin <span class="token operator">===</span> <span class="token string">'http://localhost:5500'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">var</span> data <span class="token operator">=</span> e<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
                        itemValue<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'value为'</span> <span class="token operator">+</span> data<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'请输入key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="vue-table-修改的问题"><a href="#vue-table-修改的问题" class="header-anchor">#</a> vue table 修改的问题</h2> <p>修改 table 弹出 dialog 我们不能直接把 table 的 当前行的数据赋值给 dialog 不然 table 中的数据也会跟着变化，因为是相同的引用</p> <p><strong>解决办法：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// object</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>object <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>row<span class="token punctuation">)</span>

<span class="token comment">// Array</span>
newArray <span class="token operator">=</span> oldArray<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// slice 会克隆返回一个新数组</span>
</code></pre></div><h2 id="vue-刷新当前页面"><a href="#vue-刷新当前页面" class="header-anchor">#</a> Vue 刷新当前页面</h2> <h3 id="显示隐藏router-view"><a href="#显示隐藏router-view" class="header-anchor">#</a> 显示隐藏router-view</h3> <p>目的：原生调用h5 方法重载页面，App.vue初始化的时候把方法赋值给 window</p> <p>怎么刷新：</p> <ol><li><strong><code>this.$router.go(0)</code></strong>。体验很差。页面会一瞬间的白屏。</li> <li><strong><code>location.reload()</code></strong>。这种也是一样，画面一闪，体验不是很好</li></ol> <p><strong>用<code>provide</code> / <code>inject</code> 组合</strong> 注入所有组件方法</p> <p>来控制 app.vue <code>router-view</code>的显示或隐藏</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isRouterAlive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token function">provide</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">reload</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>reload
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">isRouterAlive</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">reload</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>isRouterAlive <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>isRouterAlive <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>组件中使用：</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">inject</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'reload'</span><span class="token punctuation">]</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>初始化的时候赋值给 window 通过桥接调用</p> <div class="language-vue extra-class"><pre class="language-vue"><code>created() {
	window.reload = this.load
}
</code></pre></div><h3 id="重定向到空组件在replace"><a href="#重定向到空组件在replace" class="header-anchor">#</a> 重定向到空组件在replace</h3> <p>Redirect 组件</p> <div class="language-vue extra-class"><pre class="language-vue"><code>// Redirect.vue
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> params<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route
    <span class="token keyword">const</span> <span class="token punctuation">{</span> path <span class="token punctuation">}</span> <span class="token operator">=</span> params
    <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/'</span> <span class="token operator">+</span> path<span class="token punctuation">,</span> query <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>路由配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> constantRoutes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/redirect'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    <span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/redirect/:path(.*)'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/redirect/index'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
 <span class="token punctuation">]</span>
</code></pre></div><p>组件中使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">refreshView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> fullPath <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/redirect'</span> <span class="token operator">+</span> fullPath
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="实用-api"><a href="#实用-api" class="header-anchor">#</a> 实用 API</h1> <h2 id="intersectionobserver"><a href="#intersectionobserver" class="header-anchor">#</a> IntersectionObserver</h2> <p>用来检测某个（些）元素是否出现在可视窗口中。</p> <p>用处：图片懒加载、无限滚动等。</p> <h1 id="清除定时器后置为null"><a href="#清除定时器后置为null" class="header-anchor">#</a> 清除定时器后置为null</h1> <p>因为清除了定时器。在页面创建了大量的自定义对象，但是调用后内存无法释放，即使刷新或跳到其它页面，内存仍然没有清空，只有关闭浏览器，内存才释放，长时间使用系统会造成客户端报“虚拟内存不足，清除了定时器再赋值null可以释放内存占用。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/awesome/assets/js/app.eb163c09.js" defer></script><script src="/awesome/assets/js/2.4fcc29d0.js" defer></script><script src="/awesome/assets/js/108.0a81d75c.js" defer></script>
  </body>
</html>
